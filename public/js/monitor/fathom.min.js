!function(a,b,c){var d=function(a,b){return this.container=a,this.options=b,this.init()},e=a(b),f=a(document);d.prototype={defaults:{portable:c,portableTagName:"div",portableClass:"fathom-container",displayMode:"single",slideTagName:"div",slideClass:"slide",activeClass:"activeslide",inactiveClass:"inactiveslide",margin:100,onScrollInterval:300,scrollLength:600,easing:"swing",timeline:c,video:c,onActivateSlide:c,onDeactivateSlide:c},init:function(){return this.config=a.extend({},this.defaults,this.options),this.$container=a(this.container),this.$slides=this.$container.find(this.config.slideTagName+(this.config.slideClass?"."+this.config.slideClass:"")),this.$firstSlide=this.$slides.filter(":first"),this.$lastSlide=this.$slides.filter(":last"),this.$activeSlide=this.activateSlide(this.$firstSlide),this._detectPortable()._setStyles()._setClasses()._setMargins()._setupEvents()._setupTimeline()._setupVideo()._setupScrollHandler()},nextSlide:function(){return this.scrollToSlide(this.$activeSlide.next())},prevSlide:function(){return this.scrollToSlide(this.$activeSlide.prev())},scrollToSlide:function(b){var c=this,d=this.config.portable?this.$portableContainer:a("html,body"),f=this.config.portable?this.$portableContainer:e,g=this.config.portable?this.$portableContainer.scrollLeft():0;return 1!==b.length?b:(this.isAutoScrolling=!0,d.stop().animate({scrollLeft:b.position().left+g-(f.width()-b.innerWidth())/2},c.config.scrollLength,c.config.easing,function(){c.isAutoScrolling=!1}),this.activateSlide(b))},activateSlide:function(a){var b,d=a.get(0);if(this.$activeSlide!==c){if(b=this.$activeSlide.get(0),b===d)return a;this.$activeSlide.removeClass(this.config.activeClass).addClass(this.config.inactiveClass).trigger("deactivateslide.fathom"),"function"==typeof this.config.onDeactivateSlide&&this.config.onDeactivateSlide.call(b)}return a.removeClass(this.config.inactiveClass).addClass(this.config.activeClass),this.$activeSlide=a,a.trigger("activateslide.fathom"),"function"==typeof this.config.onActivateSlide&&this.config.onActivateSlide.call(d),a},setTime:function(a){for(var b=this._timeline||[],c=0;c<b.length;c++)if(b[c].time<=a&&b[c+1].time>a){this.$activeSlide[0]!==b[c].slide[0]&&this.scrollToSlide(b[c].slide);break}},_detectPortable:function(){return this.config.portable===c&&(this.config.portable=this.$container.parent().is("body")?!1:!0),this},_setupEvents:function(){var b=this;return this.$container.delegate(this.config.slideTagName+"."+this.config.inactiveClass,"click",function(c){c.preventDefault(),b.scrollToSlide(a(this))}),f.keydown(function(a){var c=a.which;39===c||32===c?(a.preventDefault(),b.nextSlide()):37===c&&(a.preventDefault(),b.prevSlide())}),e.resize(function(){b._setMargins()}),this},_setStyles:function(){return this.$container.css("white-space","nowrap"),this.$slides.css({"white-space":"normal",display:"inline-block","vertical-align":"top"}),this.config.portable&&(this.$portableContainer=a("<"+this.config.portableTagName+' class="'+this.config.portableClass+'" />'),this.$container.before(this.$portableContainer).appendTo(this.$portableContainer)),this},_setClasses:function(){return this.$slides.addClass(this.config.inactiveClass),this.$activeSlide.removeClass(this.config.inactiveClass).addClass(this.config.activeClass),this},_setMargins:function(){var b=this.config.displayMode,c=this.config.portable?this.$portableContainer:e,d=c.width(),f=Math.ceil((c.height()-this.$firstSlide.innerHeight())/2),g=Math.ceil((d-this.$firstSlide.innerWidth())/2),h=Math.ceil((d-this.$lastSlide.innerWidth())/2),i=Math.ceil(d/25);if(this.$container.css("margin-top",f),"single"===b?this.$slides.css("margin-right",g-i):"multi"===b&&this.$slides.css("margin-right",this.config.margin),this.$firstSlide.css("margin-left",g),this.$lastSlide.css("margin-right",h),this.config.portable){var j=parseInt(this.$container.css("padding-left"))+parseInt(this.$container.css("padding-right"));this.$slides.each(function(){j+=a(this).outerWidth(!0)}),this.$container.width(j)}return this},_setupTimeline:function(){function b(a){for(var b=(a.time||a).toString().match(/(((\d+):)?(\d+):)?(\d+)/),c=0,d=3;5>=d;d++)c=60*c+parseInt(b[d]||0);return c}function c(b){if(null==b.slide)e++;else if("number"===a.type(b.slide))e=b.slide;else for(var c=d.filter(b.slide)[0],f=0;f<d.length;f++)if(d[f]===c){e=f;break}return d.eq(e)}var d=this.$slides,e=-1;if(!this.config.timeline)return this;this._timeline=[];for(var f=this.config.timeline,g=0;g<f.length;g++)this._timeline.push({time:b(f[g]),slide:c(f[g])});return this._timeline.push({time:99999,slide:f[0].slide}),this},_setupVideo:function(){if(this.config.video){if("vimeo"!==this.config.video.source)throw"unknown video source, not supported";this._setupVimeoVideo(this.config.video)}else this._setupDefaultTimeSource();return this},_setupDefaultTimeSource:function(){var a=this,b=(new Date).getTime();setInterval(function(){var c=(new Date).getTime();a.setTime((c-b)/1e3)},250)},_setupVimeoVideo:function(c){function d(){var b="p"+c.id,d='<iframe id="'+b+'"	width="'+(c.width||360)+'" height="'+(c.height||203)+'" frameborder="0" src="http://player.vimeo.com/video/'+c.id+"?api=1&player_id="+b+'">';return a(d).appendTo(c.parent||"body")[0]}var e=this,c=this.config.video,f=!1;"file:"===b.location.protocol&&("console"in b&&console.log("vimeo video player api does not work with local files. Downgrading video support\nsee http://vimeo.com/api/docs/player-js"),f=!0),f?a(d()).bind("load",function(){e._setupDefaultTimeSource()}):a.getScript("http://a.vimeocdn.com/js/froogaloop2.min.js?",function(){$f(d()).addEvent("ready",function(a){var b=$f(a),d=!1;b.addEvent("play",function(){d===!1&&(d=setInterval(function(){b.api("getCurrentTime",function(a){e.setTime(a)})},250))}),b.addEvent("pause",function(){clearInterval(d),d=!1}),c.autoplay&&b.api("play")})})},_setupScrollHandler:function(){var b,d=this,f=d.config.slideTagName+(d.config.slideClass?"."+d.config.slideClass:""),g=this.config.portable?this.$portableContainer:e,h=null===navigator.userAgent.match(/like Mac OS X/i)?!1:!0;return d.scrolling=!1,setInterval(function(){if(d.scrolling&&(d.isAutoScrolling===!1||d.isAutoScrolling===c))if(d.scrolling=!1,0===g.scrollLeft())d.activateSlide(d.$firstSlide);else{var i=d.config.portable?g.position().left:0,j=d.config.portable?g.position().top:0,k={x:i+g.width()/2+(h?e.scrollLeft():0),y:j+g.height()/2+(h?e.scrollTop():0)};b=a(document.elementFromPoint(k.x,k.y)),b.is(f)?d.activateSlide(b):b=b.parents(f+":first").each(function(){d.activateSlide(a(this))})}},d.config.onScrollInterval),g.scroll(function(){d.scrolling=!0}),this}},a.fn.fathom=function(a){return new d(this,a),this},d.defaults=d.prototype.defaults,d.setDefaults=function(b){a.extend(d.defaults,b)},b.Fathom=d}(jQuery,window);